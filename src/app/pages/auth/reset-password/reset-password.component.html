<div class="reset-password-container">
  <h2>Recuperar contraseña</h2>

  <!-- Paso 1: Solicitar código por correo -->
  <div *ngIf="step === 'request'" class="step-container">
    <form [formGroup]="form" (ngSubmit)="submit()" class="form">
      <label>Email
        <input type="email" formControlName="email" placeholder="tu@email.com" />
      </label>
      <button type="submit" class="btn btn-primary" [disabled]="form.invalid || loading">
        {{ loading ? 'Enviando...' : 'Enviar código' }}
      </button>
      <p class="hint">Te enviaremos un código de 6 dígitos a tu correo.</p>
    </form>
  </div>

  <!-- Paso 2: Confirmar código y nueva contraseña -->
  <div *ngIf="step === 'confirm'" class="step-container">
    <div class="success-message">
      <p class="ok">✅ Código enviado a tu correo. Revisa tu bandeja de entrada y spam.</p>
    </div>
    
    <form [formGroup]="confirmForm" (ngSubmit)="confirm()" class="form">
      <label>Código de verificación
        <input type="text" formControlName="token" placeholder="123456" maxlength="6" />
      </label>
      <label>Nueva contraseña
        <input type="password" formControlName="nuevaPassword" placeholder="••••••••" />
      </label>
      <button type="submit" class="btn btn-primary" [disabled]="confirmForm.invalid || loading">
        {{ loading ? 'Restableciendo...' : 'Restablecer contraseña' }}
      </button>
      <p class="hint">El código expira en 15 minutos.</p>
      
      <button type="button" class="btn btn-secondary" (click)="goBack()">
        Volver a solicitar código
      </button>
    </form>
  </div>

  <!-- Mensaje de éxito final -->
  <div *ngIf="step === 'success'" class="step-container">
    <div class="success-final">
      <h3>✅ Contraseña restablecida exitosamente</h3>
      <p>Ya puedes iniciar sesión con tu nueva contraseña.</p>
      <a routerLink="/login" class="btn btn-primary">Ir a iniciar sesión</a>
    </div>
  </div>
</div>
