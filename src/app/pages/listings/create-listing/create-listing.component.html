<h2>Crear alojamiento</h2>
<form [formGroup]="form" (ngSubmit)="crear()" class="form">
  <div class="form-section">
    <h3>Informaci√≥n b√°sica</h3>
    <label>
      T√≠tulo *
      <input formControlName="titulo" placeholder="Ej: Hermoso apartamento en el centro" [class.error]="form.get('titulo')?.invalid && form.get('titulo')?.touched"/>
    </label>
    
    <label>
      Descripci√≥n *
      <textarea formControlName="descripcion" rows="4" placeholder="Describe tu alojamiento, sus caracter√≠sticas y lo que lo hace especial..." [class.error]="form.get('descripcion')?.invalid && form.get('descripcion')?.touched"></textarea>
    </label>
  </div>

  <div class="form-section">
    <h3>Ubicaci√≥n</h3>
    <label>
      Direcci√≥n *
      <input formControlName="direccion" placeholder="Ej: Calle 123 #45-67" [class.error]="form.get('direccion')?.invalid && form.get('direccion')?.touched"/>
    </label>
    
    <div class="form-row">
      <label>
        Ciudad *
        <input formControlName="ciudad" placeholder="Ej: Bogot√°" [class.error]="form.get('ciudad')?.invalid && form.get('ciudad')?.touched"/>
      </label>
      
      <label>
        Pa√≠s *
        <input formControlName="pais" placeholder="Ej: Colombia" [class.error]="form.get('pais')?.invalid && form.get('pais')?.touched"/>
      </label>
    </div>
  </div>

  <div class="form-section">
    <h3>Detalles del alojamiento</h3>
    <div class="form-row">
      <label>
        Precio por noche *
        <input type="number" formControlName="precioPorNoche" min="1" placeholder="100" [class.error]="form.get('precioPorNoche')?.invalid && form.get('precioPorNoche')?.touched"/>
      </label>
      <label>
        Moneda
        <select formControlName="moneda">
          <option value="USD">USD</option>
          <option value="EUR">EUR</option>
          <option value="COP">COP</option>
          <option value="MXN">MXN</option>
        </select>
      </label>
      
      <label>
        Capacidad (hu√©spedes) *
        <input type="number" formControlName="capacidad" min="1" placeholder="2" [class.error]="form.get('capacidad')?.invalid && form.get('capacidad')?.touched"/>
      </label>
    </div>
  </div>

  <div class="form-section">
    <h3>Servicios del alojamiento</h3>
    <p class="helper">Agrega servicios como WiFi, Piscina, Aire acondicionado, etc.</p>

    <div class="form-row">
      <label style="flex:1">
        Servicio
        <input #servInput type="text" placeholder="Ej: WiFi" (keydown.enter)="addService(servInput.value); servInput.value=''; $event.preventDefault()" />
      </label>
      <button type="button" class="btn btn-outline" (click)="addService(servInput.value); servInput.value=''">Agregar</button>
    </div>

    <div class="chips" *ngIf="(form.value.servicios || []).length > 0">
      <div class="chip" *ngFor="let s of form.value.servicios; let i = index">
        <span>{{ s }}</span>
        <button type="button" class="remove" (click)="removeService(i)" title="Eliminar">‚úï</button>
      </div>
    </div>

    <div class="quick-services">
      <span class="quick-title">Servicios comunes:</span>
      <button type="button" class="quick" *ngFor="let item of serviciosComunes" (click)="addService(item)">{{ item }}</button>
    </div>
  </div>

  <div class="form-section">
    <h3>Im√°genes del alojamiento</h3>
    <p class="image-requirements">
      üì∏ Sube entre {{ MIN_IMAGES }} y {{ MAX_IMAGES }} im√°genes de tu alojamiento (m√°ximo 5MB cada una)
    </p>
    
    <div class="image-upload-area">
      <label class="upload-button" [class.disabled]="!canAddMoreImages">
        <input 
          type="file" 
          (change)="onFilesSelected($event)" 
          accept="image/*" 
          multiple
          [disabled]="!canAddMoreImages"
        />
        <span *ngIf="canAddMoreImages">
          üì∑ Seleccionar im√°genes ({{ selectedFiles.length }}/{{ MAX_IMAGES }})
        </span>
        <span *ngIf="!canAddMoreImages">
          ‚úÖ M√°ximo de im√°genes alcanzado ({{ MAX_IMAGES }})
        </span>
      </label>
    </div>

    <div class="images-grid" *ngIf="photoPreviews.length > 0">
      <div class="image-preview" *ngFor="let preview of photoPreviews; let i = index">
        <img [src]="preview" [alt]="'Vista previa ' + (i + 1)" />
        <button type="button" class="remove-image" (click)="removeImage(i)" title="Eliminar imagen">
          ‚úï
        </button>
        <div class="image-number">{{ i + 1 }}</div>
      </div>
    </div>

    <div class="validation-status" [class.error]="!hasMinimumImages && selectedFiles.length > 0" [class.success]="hasMinimumImages">
      <span *ngIf="selectedFiles.length === 0">
        ‚ö†Ô∏è Debes subir al menos {{ MIN_IMAGES }} imagen(es)
      </span>
      <span *ngIf="selectedFiles.length > 0 && !hasMinimumImages">
        ‚ö†Ô∏è Necesitas {{ MIN_IMAGES - selectedFiles.length }} imagen(es) m√°s
      </span>
      <span *ngIf="hasMinimumImages">
        ‚úÖ Tienes {{ selectedFiles.length }} imagen(es) seleccionada(s)
      </span>
    </div>
  </div>

  <div class="form-actions">
    <button 
      type="submit" 
      class="btn btn-primary" 
      [disabled]="form.invalid || !hasMinimumImages || uploading" [attr.aria-busy]="uploading"
    >
      <span *ngIf="!uploading">Crear alojamiento</span>
      <span *ngIf="uploading">Subiendo im√°genes y creando...</span>
    </button>
    
    <p class="form-hint" *ngIf="form.invalid || !hasMinimumImages">
      <span *ngIf="form.invalid">‚ö†Ô∏è Completa todos los campos requeridos</span>
      <span *ngIf="!hasMinimumImages && form.valid">‚ö†Ô∏è Agrega al menos {{ MIN_IMAGES }} imagen(es)</span>
    </p>
  </div>
</form>
